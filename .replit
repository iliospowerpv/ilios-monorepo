modules = ["nodejs-20", "python-3.11", "postgresql-16"]
[agent]
expertMode = true

[nix]
channel = "stable-25_05"

[workflows]
runButton = "Project"

[[workflows.workflow]]
name = "Project"
mode = "parallel"
author = "agent"

[[workflows.workflow.tasks]]
task = "workflow.run"
args = "Frontend"

[[workflows.workflow.tasks]]
task = "workflow.run"
args = "Backend"

[[workflows.workflow]]
name = "Frontend"
author = "agent"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "cd frontend/rea-investment-fe && PORT=5000 npm start"
waitForPort = 5000

[workflows.workflow.metadata]
outputType = "webview"

[[workflows.workflow]]
name = "Backend"
author = "agent"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "cd backend/ilios-server && uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload"
waitForPort = 8000

[workflows.workflow.metadata]
outputType = "console"

[[ports]]
localPort = 5000
externalPort = 80

[[ports]]
localPort = 8000
externalPort = 8000

[[ports]]
localPort = 44807
externalPort = 3000

[deployment]
deploymentTarget = "vm"
build = ["bash", "-c", "cd frontend/rea-investment-fe && npm install && npm run build; cd backend/ilios-server && pip install -r requirements.txt"]
run = ["bash", "-c", "cd frontend/rea-investment-fe && ./node_modules/.bin/serve -s build -l 5000 & cd backend/ilios-server && gunicorn --bind 0.0.0.0:8000 --workers 4 --worker-class uvicorn.workers.UvicornWorker app.main:app"]

[userenv]

[userenv.shared]
secret_key = "21f3869f9e099b69ab9b6f74424c1545bbc2f6f4d84e0a4d7ea89c74ef377453"
api_key = "dev-api-key-placeholder"
system_user_password = "SystemUser123!"
environment_name = "dev"
mailgun_rest_api_endpoint = "https://api.mailgun.net/v3"
mailgun_api_key = "placeholder-mailgun-key"
mailgun_domain_name = "placeholder.mailgun.org"
default_email_sender = "noreply@example.com"
invitation_url = "https://example.com/invite"
password_reset_url = "https://example.com/reset-password"
login_url = "https://example.com/login"
support_email = "support@example.com"
file_parse_function_url = "https://placeholder-function.com/parse"
co_terminus_function_url = "https://placeholder-function.com/co-terminus"
chatbot_upload_file_function_url = "https://placeholder-function.com/chatbot-upload"
chatbot_mark_actual_function_url = "https://placeholder-function.com/chatbot-mark"
chatbot_delete_file_function_url = "https://placeholder-function.com/chatbot-delete"
chatbot_session_token_function_url = "https://placeholder-function.com/chatbot-token"
ml_api_key = "placeholder-ml-api-key"
telemetry_token_function_url = "https://placeholder-function.com/telemetry-token"
telemetry_sites_function_url = "https://placeholder-function.com/telemetry-sites"
telemetry_devices_function_url = "https://placeholder-function.com/telemetry-devices"
telemetry_device_static_info_func_url = "https://placeholder-function.com/telemetry-static"
gcp_project_id = "123456789"
rombus_api_key = "placeholder-rombus-key"
redis_url = "redis://localhost:6379"
pbi_tenant_id = "placeholder-tenant-id"
pbi_client_id = "placeholder-client-id"
pbi_client_secret = "placeholder-client-secret"
pbi_workspace_id = "placeholder-workspace-id"
REPLIT_SKIP_NPM_INSTALL = "1"

[userenv.development]
db_host = "helium"
db_user = "postgres"
db_password = "password"
db_name = "heliumdb"
REACT_APP_URL = "https://866eea6d-1ee6-48a6-8cf4-5fad9fd453a4-00-25dsz23h560r9.picard.replit.dev:8000"
